<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <img src="logob.png">
    <title>Ultimate Egg Boiler Pro</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&family=Quicksand:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        :root {
            --primary-color: #ff9f43;
            --secondary-color: #feca57;
            --accent-color: #ff6b6b;
            --background-color: #fff8f0;
            --text-color: #3d3d3d;
            --card-bg: rgba(255, 255, 255, 0.92);
            --card-shadow: rgba(0,0,0,0.1);
            --cozy-texture: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='40' height='40' viewBox='0 0 40 40'%3E%3Cg fill-rule='evenodd'%3E%3Cg fill='%23ff9f43' fill-opacity='0.05'%3E%3Cpath d='M0 38.59l2.83-2.83 1.41 1.41L1.41 40H0v-1.41zM0 1.4l2.83 2.83 1.41-1.41L1.41 0H0v1.41zM38.59 40l-2.83-2.83 1.41-1.41L40 38.59V40h-1.41zM40 1.41l-2.83 2.83-1.41-1.41L38.59 0H40v1.41zM20 18.6l2.83-2.83 1.41 1.41L21.41 20l2.83 2.83-1.41 1.41L20 21.41l-2.83 2.83-1.41-1.41L18.59 20l-2.83-2.83 1.41-1.41L20 18.59z'/%3E%3C/g%3E%3C/g%3E%3C/svg%3E");
        }

        /* Dark Mode Styles */
        body.dark-mode {
            --background-color: #1a1a1a;
            --text-color: #f0f0f0;
            --card-bg: rgba(45, 45, 45, 0.92);
            --card-shadow: rgba(0,0,0,0.3);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Quicksand', sans-serif;
            transition: all 0.3s ease;
        }

        body {
            background-color: var(--background-color);
            color: var(--text-color);
            min-height: 100vh;
            padding: 20px;
            display: flex;
            flex-direction: column;
            align-items: center;
            background-attachment: fixed;
            position: relative;
            overflow-x: hidden;
        }
         body::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-image: var(--cozy-texture);
            opacity: 0.1;
            z-index: -1;
        }

        .container {
            width: 100%;
            max-width: 550px;
            margin: 0 auto;
            z-index: 1;
        }

        header {
            text-align: center;
            margin-bottom: 25px;
            padding: 20px;
            background: var(--card-bg);
            border-radius: 20px;
            box-shadow: 0 10px 30px var(--card-shadow);
            position: relative;
            overflow: hidden;
            border-top: 5px solid var(--primary-color);
            animation: fadeIn 1s ease-out;
        }

        .logo {
            font-size: 2.8rem;
            font-weight: bold;
            margin-bottom: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: var(--primary-color);
            font-family: 'Poppins', sans-serif;
            text-shadow: 2px 2px 0px rgba(255, 255, 255, 0.1);
        }
         .logo i { margin-right: 15px; }
        h1 {
            font-size: 2.2rem;
            margin-bottom: 5px;
            font-weight: 700;
        }
        .tagline { font-size: 1.1rem; opacity: 0.8;}

        .card {
            background: var(--card-bg);
            border-radius: 20px;
            padding: 25px;
            text-align: center;
            margin-bottom: 25px;
            box-shadow: 0 10px 30px var(--card-shadow);
            position: relative;
            animation: slideUp 0.5s ease-out;
        }
        
        h2.section-title {
            font-size: 1.5rem;
            margin-bottom: 15px;
            color: var(--primary-color);
            font-weight: 600;
        }

        /* Egg Selector */
        .egg-selector {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 20px;
        }
        .egg-type {
            background: transparent;
            border-radius: 20px;
            padding: 20px;
            text-align: center;
            cursor: pointer;
            position: relative;
            border: 2px solid var(--text-color);
            opacity: 0.7;
            transition: all 0.3s ease;
        }
        .egg-type:hover {
            transform: translateY(-8px) scale(1.03);
            opacity: 1;
        }
        .egg-type.selected {
            border: 3px solid var(--primary-color);
            background: rgba(255, 159, 67, 0.1);
            transform: translateY(-5px) scale(1.05);
            opacity: 1;
        }
         .egg-type i { font-size: 3rem; color: var(--primary-color); margin-bottom: 15px;}
        .egg-type h3 { margin-bottom: 8px; font-weight: 600; }
        .egg-type p { font-size: 0.95rem; opacity: 0.8; }
        
        /* Advanced Settings */
        .advanced-settings { display: flex; justify-content: space-around; gap: 15px; margin-top: 20px; flex-wrap: wrap; }
        .setting { display: flex; flex-direction: column; align-items: center; }
        .setting label { margin-bottom: 10px; font-weight: 500; }
        .setting select, .setting input {
            background: var(--background-color);
            color: var(--text-color);
            border: 2px solid var(--text-color);
            border-radius: 10px;
            padding: 5px 10px;
            text-align: center;
        }
        
        /* Timer */
        .timer-display { font-size: 4.5rem; font-weight: bold; margin: 20px 0; font-family: 'Poppins', monospace; color: var(--primary-color); }
        .egg-progress { height: 8px; background: var(--text-color); opacity: 0.2; border-radius: 4px; margin: 15px 0; overflow: hidden; }
        .egg-progress-bar { height: 100%; background: var(--primary-color); border-radius: 4px; width: 0%; transition: width 1s linear; }

        .timer-controls { display: flex; justify-content: center; gap: 15px; flex-wrap: wrap; }
        button {
            background: var(--primary-color); border: none; color: white; padding: 12px 25px;
            border-radius: 50px; cursor: pointer; font-weight: 600;
            box-shadow: 0 4px 10px rgba(0,0,0, 0.2); display: flex; align-items: center; gap: 8px;
            transition: all 0.3s ease;
        }
        button:hover { transform: translateY(-3px); box-shadow: 0 6px 15px rgba(0,0,0, 0.3); }
        button:active { transform: translateY(1px); }
        .stop-btn { background: var(--accent-color); }
        .reset-btn { background: #8395a7; }

        /* Optichain Boiler AI */
        #aiBoiler { text-align: left; }
        .ai-response {
            background: var(--background-color); border-radius: 10px;
            padding: 15px; margin-top: 15px; min-height: 100px;
            opacity: 0.8;
            border: 1px solid var(--text-color);
            max-height: 300px;
            overflow-y: auto;
        }
        .ai-message {
            margin-bottom: 10px;
            padding: 8px 12px;
            border-radius: 15px;
            max-width: 80%;
            animation: fadeIn 0.5s ease-out;
        }
        .user-message {
            background-color: rgba(255, 159, 67, 0.2);
            margin-left: auto;
            text-align: right;
        }
        .ai-message-content {
            background-color: rgba(108, 92, 231, 0.2);
            margin-right: auto;
        }
        .ai-input-container {
            display: flex;
            margin-top: 15px;
            gap: 10px;
        }
        #aiInput {
            flex: 1;
            padding: 10px 15px;
            border-radius: 25px;
            border: 2px solid var(--text-color);
            background: var(--background-color);
            color: var(--text-color);
        }
        #sendAiBtn {
            border-radius: 50%;
            width: 45px;
            height: 45px;
            padding: 0;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        #askAiBtn { margin: 15px auto 0; display: block; background: #6c5ce7; }
        
        /* Nutrition Info */
        .nutrition-info {
            margin-top: 15px;
            padding: 10px;
            background: rgba(108, 92, 231, 0.1);
            border-radius: 10px;
            font-size: 0.9rem;
        }
        
        /* Customization & Footer */
        .customization { display: flex; justify-content: space-around; align-items: center;}
        .color-picker { display: flex; gap: 10px; }
        .color-option { width: 35px; height: 35px; border-radius: 50%; cursor: pointer; border: 3px solid var(--background-color); box-shadow: 0 2px 5px rgba(0,0,0,0.2);}
        .dark-mode-toggle { display: flex; align-items: center; gap: 10px; }
        .switch { position: relative; display: inline-block; width: 50px; height: 28px;}
        .switch input { opacity: 0; width: 0; height: 0;}
        .slider { position: absolute; cursor: pointer; top: 0; left: 0; right: 0; bottom: 0; background-color: #ccc; border-radius: 34px;}
        .slider:before { position: absolute; content: ""; height: 20px; width: 20px; left: 4px; bottom: 4px; background-color: white; border-radius: 50%; transition: .4s;}
        input:checked + .slider { background-color: var(--primary-color); }
        input:checked + .slider:before { transform: translateX(22px); }

        .footer { text-align: center; margin-top: 20px; font-size: 1rem;}
        .footer a { color: var(--primary-color); text-decoration: none; font-weight: 600;}
        .footer a:hover { text-decoration: underline; }

        /* Animations */
        @keyframes pulse { 
            0% { transform: scale(1); } 
            50% { transform: scale(1.05); } 
            100% { transform: scale(1); } 
        }
        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }
        @keyframes slideUp {
            from { transform: translateY(20px); opacity: 0; }
            to { transform: translateY(0); opacity: 1; }
        }
        @keyframes float {
            0% { transform: translateY(0px); }
            50% { transform: translateY(-10px); }
            100% { transform: translateY(0px); }
        }
        @keyframes eggBoil {
            0% { transform: scale(1) rotate(0deg); }
            25% { transform: scale(1.05) rotate(2deg); }
            50% { transform: scale(1.1) rotate(0deg); }
            75% { transform: scale(1.05) rotate(-2deg); }
            100% { transform: scale(1) rotate(0deg); }
        }
        
        .pulse { animation: pulse 1s infinite; }
        .float { animation: float 3s ease-in-out infinite; }
        .egg-boil { animation: eggBoil 2s ease-in-out infinite; }
        
        /* Floating elements for zen effect */
        .floating-element {
            position: absolute;
            opacity: 0.1;
            z-index: -1;
        }
        .floating-element-1 {
            top: 10%;
            left: 5%;
            animation: float 8s ease-in-out infinite;
        }
        .floating-element-2 {
            top: 40%;
            right: 5%;
            animation: float 10s ease-in-out infinite 1s;
        }
        .floating-element-3 {
            bottom: 20%;
            left: 10%;
            animation: float 12s ease-in-out infinite 2s;
        }
        
        @media (max-width: 500px) {
            .egg-selector, .advanced-settings { grid-template-columns: 1fr; }
            .timer-display { font-size: 3.5rem; }
            .timer-controls { flex-direction: column; align-items: center; }
            button { width: 80%; justify-content: center; }
            .customization { flex-direction: column; gap: 20px; }
        }
    </style>
</head>
<body>
    <div class="floating-element floating-element-1">ü•ö</div>
    <div class="floating-element floating-element-2">üç≥</div>
    <div class="floating-element floating-element-3">üî•</div>
    
    <div class="container">
        <header>
            <div class="logo"><i class="fas fa-egg"></i><span>Egg Master Pro</span></div>
            <h1>The Ultimate Egg Boiler</h1>
            <p class="tagline">Perfect eggs, adjusted for you!</p>
        </header>

        <div class="card egg-settings">
            <h2 class="section-title">1. Choose Your Doneness</h2>
            <div class="egg-selector">
                <div class="egg-type selected" data-time="240">
                    <i class="fas fa-tint-slash"></i><h3>Soft Boiled</h3><p>Runny yolk</p>
                </div>
                <div class="egg-type" data-time="360">
                     <i class="fas fa-adjust"></i><h3>Medium Boiled</h3><p>Creamy yolk</p>
                </div>
                <div class="egg-type" data-time="540">
                     <i class="fas fa-circle"></i><h3>Hard Boiled</h3><p>Fully set yolk</p>
                </div>
                <div class="egg-type" data-time="720">
                     <i class="fas fa-egg"></i><h3>Well Done</h3><p>Fully cooked through</p>
                </div>
            </div>
            <h2 class="section-title" style="margin-top: 20px;">2. Fine-Tune Settings</h2>
            <div class="advanced-settings">
                <div class="setting">
                    <label for="eggSize">Egg Size:</label>
                    <select id="eggSize">
                        <option value="0" selected>Medium</option>
                        <option value="60">Large</option>
                        <option value="120">X-Large</option>
                    </select>
                </div>
                <div class="setting">
                    <label for="altitude">Altitude (in meters):</label>
                    <input type="number" id="altitude" value="0" step="100">
                </div>
                <div class="setting">
                    <label for="quantity">Quantity:</label>
                    <input type="number" id="quantity" value="1" min="1" max="12">
                </div>
            </div>
        </div>

        <div class="card timer-container">
            <h2 class="section-title">3. Start the Timer</h2>
            <div class="timer-display" id="timer">04:00</div>
            <div class="egg-progress">
                <div class="egg-progress-bar" id="eggProgress"></div>
            </div>
            <div class="timer-controls">
                <button class="start-btn" id="startBtn"><i class="fas fa-play"></i>Start</button>
                <button class="stop-btn" id="stopBtn"><i class="fas fa-pause"></i>Pause</button>
                <button class="reset-btn" id="resetBtn"><i class="fas fa-redo"></i>Reset</button>
            </div>
        </div>

        <div class="card" id="aiBoiler">
            <h2 class="section-title"><i class="fas fa-robot"></i> Optichain Boiler AI</h2>
            <p>Chat with our AI chef for egg recipes from around the world!</p>
            <div class="ai-response" id="aiResponse">
                <div class="ai-message ai-message-content">
                    Hello! I'm your egg cooking assistant. Ask me for recipes, tips, or information about eggs!
                </div>
            </div>
            <div class="ai-input-container">
                <input type="text" id="aiInput" placeholder="Ask about egg recipes...">
                <button id="sendAiBtn"><i class="fas fa-paper-plane"></i></button>
            </div>
            <div class="nutrition-info" id="nutritionInfo" style="display: none;">
                <strong>Nutrition Information:</strong> <span id="calories"></span> calories, <span id="protein"></span> protein
            </div>
        </div>

        <div class="card customization">
            <div>
                 <h3>Theme Color</h3>
                <div class="color-picker" id="colorPicker">
                    <div class="color-option" style="background-color: #ff9f43;" data-primary="#ff9f43"></div>
                    <div class="color-option" style="background-color: #54a0ff;" data-primary="#54a0ff"></div>
                    <div class="color-option" style="background-color: #a29bfe;" data-primary="#a29bfe"></div>
                    <div class="color-option" style="background-color: #ff7979;" data-primary="#ff7979"></div>
                </div>
            </div>
            <div class="dark-mode-toggle">
                <h3>Dark Mode</h3>
                <label class="switch">
                  <input type="checkbox" id="darkModeToggle">
                  <span class="slider"></span>
                </label>
            </div>
        </div>

        <div class="footer">
             <p>Enhanced with <i class="fas fa-heart" style="color: #ff6b6b;"></i> from the original by Cozytustudios</p>
             <p>Visit our showcase: <a href="https://cozytusstudio-showcase-9bg3htb.gamma.site/cozytustudio?fbclid=IwY2xjawGEX-FleHRuA2FlbQIxMAABHTgq2JoSAmnpMjdzedvXYHAXZkEkt2t2umMFZErjjez1txBBg9GmBKrcNQ_aem_T23CFp6iYhA1q8eJuUu_5A" target="_blank">Cozytustudio Showcase</a></p>
        </div>
    </div>

    <audio id="alarmSound" src="https://assets.mixkit.co/sfx/preview/mixkit-kitchen-microwave-1106.mp3" preload="auto"></audio>
    <script>
    document.addEventListener('DOMContentLoaded', () => {
        const UIElements = {
            timerDisplay: document.getElementById('timer'),
            startBtn: document.getElementById('startBtn'),
            stopBtn: document.getElementById('stopBtn'),
            resetBtn: document.getElementById('resetBtn'),
            eggTypes: document.querySelectorAll('.egg-type'),
            alarmSound: document.getElementById('alarmSound'),
            colorOptions: document.querySelectorAll('.color-option'),
            eggProgress: document.getElementById('eggProgress'),
            eggSize: document.getElementById('eggSize'),
            altitude: document.getElementById('altitude'),
            quantity: document.getElementById('quantity'),
            darkModeToggle: document.getElementById('darkModeToggle'),
            aiInput: document.getElementById('aiInput'),
            sendAiBtn: document.getElementById('sendAiBtn'),
            aiResponse: document.getElementById('aiResponse'),
            nutritionInfo: document.getElementById('nutritionInfo'),
            calories: document.getElementById('calories'),
            protein: document.getElementById('protein')
        };

        const AppState = {
            countdown: null,
            totalSeconds: 240,
            secondsRemaining: 240,
            baseTime: 240,
            isRunning: false,
            selectedEggType: 'soft',
            conversationHistory: []
        };

        // Expanded egg recipes database
        const EggRecipes = [
            {
                name: "Shakshuka (Middle East/North Africa)",
                description: "A popular dish of eggs poached in a flavorful sauce of tomatoes, chili peppers, and onions. Best served with crusty bread to soak up the sauce.",
                calories: 350,
                protein: "18g",
                keywords: ["shakshuka", "middle eastern", "north african", "poached", "tomato"]
            },
            {
                name: "Huevos Rancheros (Mexico)",
                description: "Fried eggs served on corn tortillas topped with a tomato-chili sauce. Often accompanied by refried beans, avocado, and rice.",
                calories: 420,
                protein: "20g",
                keywords: ["huevos rancheros", "mexican", "fried", "tortilla", "beans"]
            },
            {
                name: "Tamagoyaki (Japan)",
                description: "A sweet and savory Japanese rolled omelette made by rolling together several layers of cooked egg. A staple of Japanese bento boxes.",
                calories: 180,
                protein: "12g",
                keywords: ["tamagoyaki", "japanese", "rolled", "omelette", "bento"]
            },
            {
                name: "Century Egg (China)",
                description: "A delicacy made by preserving duck, chicken, or quail eggs in a mixture of clay, ash, salt, quicklime, and rice hulls for several weeks to several months. The yolk becomes dark green and creamy, and the white becomes a dark brown, translucent jelly.",
                calories: 155,
                protein: "14g",
                keywords: ["century egg", "chinese", "preserved", "delicacy"]
            },
            {
                name: "Scotch Egg (United Kingdom)",
                description: "A hard or soft-boiled egg wrapped in sausage meat, coated in breadcrumbs, and deep-fried or baked. A popular picnic food.",
                calories: 320,
                protein: "19g",
                keywords: ["scotch egg", "british", "sausage", "fried", "picnic"]
            },
            {
                name: "Oeufs en Meurette (France)",
                description: "Poached eggs in a red wine sauce with onions, mushrooms, and bacon. A classic French dish from Burgundy.",
                calories: 380,
                protein: "16g",
                keywords: ["french", "poached", "wine sauce", "burgundy"]
            },
            {
                name: "Egg Curry (India)",
                description: "Hard-boiled eggs in a spicy, aromatic curry sauce made with tomatoes, onions, and Indian spices. Served with rice or bread.",
                calories: 310,
                protein: "17g",
                keywords: ["indian", "curry", "spicy", "hard-boiled"]
            },
            {
                name: "Chawanmushi (Japan)",
                description: "A delicate savory egg custard steamed with ingredients like shrimp, chicken, and mushrooms. Served as an appetizer.",
                calories: 120,
                protein: "11g",
                keywords: ["japanese", "custard", "steamed", "savory"]
            },
            {
                name: "Kai Jeow (Thailand)",
                description: "A fluffy Thai-style omelette often served with rice and sweet chili sauce. Crispy on the outside and soft inside.",
                calories: 250,
                protein: "14g",
                keywords: ["thai", "omelette", "crispy", "chili sauce"]
            },
            {
                name: "Menemen (Turkey)",
                description: "A traditional Turkish dish made with scrambled eggs, tomatoes, green peppers, and spices, often cooked and served in a metal pan.",
                calories: 280,
                protein: "15g",
                keywords: ["turkish", "scrambled", "tomatoes", "peppers"]
            }
        ];

        // Egg cooking tips
        const EggTips = [
            "For easier peeling, add a teaspoon of baking soda to the water.",
            "Use older eggs for hard boiling as they peel more easily.",
            "To prevent green rings around yolks, avoid overcooking and cool eggs quickly after cooking.",
            "Room temperature eggs are less likely to crack when placed in boiling water.",
            "Add a pinch of salt to the water to make peeling easier and prevent cracking.",
            "For perfect soft-boiled eggs, place them in ice water immediately after cooking to stop the cooking process.",
            "To tell if an egg is fresh, place it in water: fresh eggs sink, while older eggs float.",
            "For creamy scrambled eggs, cook them low and slow, stirring constantly.",
            "When poaching eggs, add a splash of vinegar to the water to help the whites coagulate faster.",
            "For fluffy omelets, add a little water or milk to the eggs before beating."
        ];

        function formatTime(seconds) {
            const minutes = Math.floor(seconds / 60);
            const remainderSeconds = seconds % 60;
            return `${minutes < 10 ? '0' : ''}${minutes}:${remainderSeconds < 10 ? '0' : ''}${remainderSeconds}`;
        }

        function updateDisplay() {
            UIElements.timerDisplay.textContent = formatTime(AppState.secondsRemaining);
            const progress = AppState.totalSeconds > 0 ? ((AppState.totalSeconds - AppState.secondsRemaining) / AppState.totalSeconds) * 100 : 0;
            UIElements.eggProgress.style.width = `${progress}%`;
            
            // Add boiling animation when timer is running
            if (AppState.isRunning && !UIElements.timerDisplay.classList.contains('egg-boil')) {
                UIElements.timerDisplay.classList.add('egg-boil');
            } else if (!AppState.isRunning) {
                UIElements.timerDisplay.classList.remove('egg-boil');
            }
        }

        function calculateTotalSeconds() {
            const sizeAdjustment = parseInt(UIElements.eggSize.value, 10);
            const altitudeValue = parseInt(UIElements.altitude.value, 10);
            const quantityValue = parseInt(UIElements.quantity.value, 10);
            
            // Boiling point of water decreases by ~1¬∞C for every 300 meters.
            // A rough adjustment is to add 10% to cook time for every 1000m.
            const altitudeAdjustment = Math.floor(AppState.baseTime * (altitudeValue / 10000));
            
            // Slight adjustment for quantity (more eggs need slightly more time)
            const quantityAdjustment = Math.floor(AppState.baseTime * ((quantityValue - 1) * 0.05));
            
            AppState.totalSeconds = AppState.baseTime + sizeAdjustment + altitudeAdjustment + quantityAdjustment;
            resetTimer();
        }

        function startTimer() {
            if (AppState.isRunning) return;
            AppState.isRunning = true;
            UIElements.startBtn.innerHTML = '<i class="fas fa-play"></i> Resume';
            
            AppState.countdown = setInterval(() => {
                AppState.secondsRemaining--;
                updateDisplay();
                if (AppState.secondsRemaining <= 0) {
                    finishTimer();
                }
            }, 1000);
        }

        function stopTimer() {
            if (!AppState.isRunning) return;
            clearInterval(AppState.countdown);
            AppState.isRunning = false;
            UIElements.timerDisplay.classList.remove('egg-boil');
        }

        function resetTimer() {
            clearInterval(AppState.countdown);
            AppState.isRunning = false;
            AppState.secondsRemaining = AppState.totalSeconds;
            UIElements.timerDisplay.classList.remove('pulse');
            UIElements.timerDisplay.classList.remove('egg-boil');
            UIElements.alarmSound.pause();
            UIElements.alarmSound.currentTime = 0;
            UIElements.startBtn.innerHTML = '<i class="fas fa-play"></i> Start';
            updateDisplay();
        }
        
        function finishTimer(){
            clearInterval(AppState.countdown);
            UIElements.timerDisplay.classList.add('pulse');
            UIElements.timerDisplay.classList.remove('egg-boil');
            UIElements.alarmSound.play();
            AppState.isRunning = false;
            UIElements.startBtn.innerHTML = '<i class="fas fa-play"></i> Start';
            
            // Show notification
            if (Notification.permission === 'granted') {
                new Notification('Egg Timer Complete', {
                    body: `Your ${AppState.selectedEggType} eggs are ready!`,
                    icon: 'https://cdn-icons-png.flaticon.com/512/184/184517.png'
                });
            }
        }
        
        function selectEggType(event) {
            UIElements.eggTypes.forEach(e => e.classList.remove('selected'));
            const selectedEgg = event.currentTarget;
            selectedEgg.classList.add('selected');
            AppState.baseTime = parseInt(selectedEgg.getAttribute('data-time'), 10);
            
            // Set egg type for AI
            if (selectedEgg.querySelector('.fa-tint-slash')) AppState.selectedEggType = 'soft';
            else if (selectedEgg.querySelector('.fa-adjust')) AppState.selectedEggType = 'medium';
            else if (selectedEgg.querySelector('.fa-circle')) AppState.selectedEggType = 'hard';
            else AppState.selectedEggType = 'well done';
            
            calculateTotalSeconds();
        }
        
        function changeThemeColor(event) {
            const primary = event.currentTarget.getAttribute('data-primary');
            document.documentElement.style.setProperty('--primary-color', primary);
            
            // Add animation effect
            event.currentTarget.classList.add('pulse');
            setTimeout(() => {
                event.currentTarget.classList.remove('pulse');
            }, 500);
        }

        function toggleDarkMode() {
            document.body.classList.toggle('dark-mode');
            
            // Add floating animation to elements when switching modes
            const cards = document.querySelectorAll('.card');
            cards.forEach(card => {
                card.classList.add('float');
                setTimeout(() => {
                    card.classList.remove('float');
                }, 1000);
            });
        }

        // Enhanced AI function with natural language processing
        function processAIQuery(query) {
            query = query.toLowerCase();
            let response = '';
            let recipe = null;
            let showNutrition = false;
            
            // Check if query is a greeting
            if (query.includes('hello') || query.includes('hi') || query.includes('hey')) {
                response = "Hello! I'm your egg cooking assistant. I can help you with recipes, cooking tips, and egg information. What would you like to know?";
            }
            // Check for recipe requests
            else if (query.includes('recipe') || query.includes('dish') || query.includes('food')) {
                // Check for specific cuisine
                for (const r of EggRecipes) {
                    for (const keyword of r.keywords) {
                        if (query.includes(keyword)) {
                            recipe = r;
                            break;
                        }
                    }
                    if (recipe) break;
                }
                
                // If no specific recipe found, pick a random one
                if (!recipe) {
                    recipe = EggRecipes[Math.floor(Math.random() * EggRecipes.length)];
                }
                
                response = `<strong>${recipe.name}:</strong> ${recipe.description}`;
                showNutrition = true;
                
                // Update nutrition info
                UIElements.calories.textContent = recipe.calories;
                UIElements.protein.textContent = recipe.protein;
            }
            // Check for cooking tips
            else if (query.includes('tip') || query.includes('advice') || query.includes('how to')) {
                const randomTip = EggTips[Math.floor(Math.random() * EggTips.length)];
                response = `<strong>Cooking Tip:</strong> ${randomTip}`;
            }
            // Check for nutrition information
            else if (query.includes('calori') || query.includes('nutrition') || query.includes('protein')) {
                response = "A large egg typically contains about 70-80 calories, 6g of protein, 5g of fat, and various vitamins and minerals. The exact values can vary based on the egg size and cooking method.";
            }
            // Check for cooking time questions
            else if (query.includes('time') || query.includes('how long')) {
                response = `For ${AppState.selectedEggType} boiled eggs, the recommended cooking time is ${formatTime(AppState.baseTime)}. This can vary based on egg size, altitude, and quantity.`;
            }
            // Default response
            else {
                response = "I'm not sure I understand. You can ask me for egg recipes from around the world, cooking tips, or nutrition information. Try asking something like 'Give me a recipe from Japan' or 'How do I make perfect hard-boiled eggs?'";
            }
            
            return { response, recipe, showNutrition };
        }

        function addMessageToChat(message, isUser = false) {
            const messageElement = document.createElement('div');
            messageElement.classList.add('ai-message');
            messageElement.classList.add(isUser ? 'user-message' : 'ai-message-content');
            messageElement.innerHTML = message;
            UIElements.aiResponse.appendChild(messageElement);
            UIElements.aiResponse.scrollTop = UIElements.aiResponse.scrollHeight;
        }

        function handleAIQuery() {
            const query = UIElements.aiInput.value.trim();
            if (!query) return;
            
            // Add user message to chat
            addMessageToChat(query, true);
            
            // Clear input
            UIElements.aiInput.value = '';
            
            // Process query and get response
            const { response, showNutrition } = processAIQuery(query);
            
            // Simulate AI "thinking" with a slight delay
            setTimeout(() => {
                addMessageToChat(response);
                
                // Show nutrition info if applicable
                if (showNutrition) {
                    UIElements.nutritionInfo.style.display = 'block';
                } else {
                    UIElements.nutritionInfo.style.display = 'none';
                }
                
                // Add to conversation history
                AppState.conversationHistory.push({ user: query, ai: response });
            }, 800);
        }

        // Request notification permission
        if ('Notification' in window) {
            Notification.requestPermission();
        }

        // Event Listeners
        UIElements.startBtn.addEventListener('click', startTimer);
        UIElements.stopBtn.addEventListener('click', stopTimer);
        UIElements.resetBtn.addEventListener('click', resetTimer);
        UIElements.eggTypes.forEach(egg => egg.addEventListener('click', selectEggType));
        UIElements.colorOptions.forEach(option => option.addEventListener('click', changeThemeColor));
        UIElements.eggSize.addEventListener('change', calculateTotalSeconds);
        UIElements.altitude.addEventListener('input', calculateTotalSeconds);
        UIElements.quantity.addEventListener('input', calculateTotalSeconds);
        UIElements.darkModeToggle.addEventListener('change', toggleDarkMode);
        UIElements.sendAiBtn.addEventListener('click', handleAIQuery);
        UIElements.aiInput.addEventListener('keypress', (e) => {
            if (e.key === 'Enter') handleAIQuery();
        });
        
        // Initial setup
        calculateTotalSeconds();
        
        // Add initial animation to elements
        setTimeout(() => {
            document.querySelectorAll('.egg-type').forEach((egg, index) => {
                egg.style.animationDelay = `${index * 0.1}s`;
                egg.classList.add('float');
            });
            
            document.querySelector('.timer-display').classList.add('float');
        }, 500);
    });
    </script>
</body>
</html>
